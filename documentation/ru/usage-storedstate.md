# Использование StoredState

`StoredState` — это компонент библиотеки **AppState**, который позволяет хранить и сохранять небольшие объемы данных с помощью `UserDefaults`. Он идеально подходит для хранения легковесных, неконфиденциальных данных, которые должны сохраняться между запусками приложения.

## Обзор

- **StoredState** построен на основе `UserDefaults`, что означает, что он быстр и эффективен для хранения небольших объемов данных (таких как пользовательские настройки или настройки приложения).
- Данные, сохраненные в **StoredState**, сохраняются между сеансами приложения, что позволяет восстанавливать состояние приложения при запуске.

### Ключевые особенности

- **Постоянное хранилище**: данные, сохраненные в `StoredState`, остаются доступными между запусками приложения.
- **Обработка небольших данных**: лучше всего использовать для легковесных данных, таких как настройки, переключатели или небольшие конфигурации.
- **Потокобезопасность**: `StoredState` обеспечивает безопасный доступ к данным в многопоточных средах.

## Пример использования

### Определение StoredState

Вы можете определить **StoredState**, расширив объект `Application` и объявив свойство состояния:

```swift
import AppState

extension Application {
    var userPreferences: StoredState<String> {
        storedState(initial: "Default Preferences", id: "userPreferences")
    }
}
```

### Доступ и изменение StoredState в представлении

Вы можете получать доступ и изменять значения **StoredState** в представлениях SwiftUI с помощью обертки свойства `@StoredState`:

```swift
import AppState
import SwiftUI

struct PreferencesView: View {
    @StoredState(\.userPreferences) var userPreferences: String

    var body: some View {
        VStack {
            Text("Настройки: \(userPreferences)")
            Button("Обновить настройки") {
                userPreferences = "Updated Preferences"
            }
        }
    }
}
```

## Обработка миграции данных

По мере развития вашего приложения вы можете обновлять модели, которые сохраняются с помощью **StoredState**. При обновлении вашей модели данных обеспечьте обратную совместимость. Например, вы можете добавить новые поля или версионировать свою модель для обработки миграции.

Для получения дополнительной информации обратитесь к [Руководству по вопросам миграции](migration-considerations.md).

### Вопросы миграции

- **Добавление новых необязательных полей**: убедитесь, что новые поля являются необязательными или имеют значения по умолчанию для поддержания обратной совместимости.
- **Версионирование моделей**: если ваша модель данных со временем изменяется, включите поле `version` для управления различными версиями ваших сохраненных данных.

## Лучшие практики

- **Используйте для небольших данных**: храните легковесные, неконфиденциальные данные, которые должны сохраняться между запусками приложения, например, пользовательские настройки.
- **Рассмотрите альтернативы для больших данных**: если вам нужно хранить большие объемы данных, рассмотрите возможность использования **FileState**.

## Заключение

**StoredState** — это простой и эффективный способ сохранения небольших фрагментов данных с помощью `UserDefaults`. Он идеально подходит для сохранения настроек и других небольших параметров между запусками приложения, обеспечивая при этом безопасный доступ и простую интеграцию с SwiftUI. Для более сложных потребностей в сохранении изучите другие функции **AppState**, такие как [FileState](usage-filestate.md) или [SyncState](usage-syncstate.md).

---
Это было сгенерировано с использованием Jules, могут возникнуть ошибки. Пожалуйста, сделайте Pull Request с любыми исправлениями, которые должны произойти, если вы носитель языка.
